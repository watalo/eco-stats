# 第11章 二值选择模型
## 11.1 二值选择模型的例子

- 解释变量是离散的，不影响回归。
	- 比如虚拟变量
- 被解释变量是离散的，不适合进行OLS回归。
	- 离散选择模型、定性反应模型
	- 最常见的：二值选择行为

> #定义 线性概率模型（Linear Probility Model）$$\left \{ \begin{array}{l} 
P(y=1|x)= F(x,\beta)  \\ 
P(y=0|x)= 1-F(x,\beta)    
\end{array} \right.$$
> - 连接函数：$F(x,\beta)$
>- 通过选择合适的链接函数，可以保证 $0\le \hat y \le1$ 。例如：
>	- Probit模型：正态分布的累积函数$$\Phi(x'\beta)\equiv \int_{- \infty}^{x'\beta}\phi(t)dt$$
>	- Logit模型：逻辑分布的累积函数$$\Lambda(x'\beta)\equiv\frac{exp(x'\beta)}{1+exp(x'\beta)}$$

Logit模型优势：逻辑分布的CDF有解释表达式，计算方便，回归系数更具经济意义
## 11.2 最大似然估计的原理

非线性模型，无法通过变量转换转为线性模型，常使用最大似然估计法（Maxinum Likeihood Estimate）

> #定义 最大似然估计法（Maxinum Likeihood Estimate）
似然函数（Likehood function）$$L(\theta\ ;\ y_1,\cdots,y_n)=\prod_{i=1}^{n}f(y_i\ ;\ \theta)$$
对数似然函数（log-Likehood function）$$\ln L(\theta\ ;y_1,\cdots,y_n) = \sum_{i=1}^{n} \ln f(y_i \ ;\ \theta)$$
给定样本取值后，该样本最有可能来自参数 $\theta$ 为何值的总体。换言之，寻找 $\hat \theta_{ML}$ 使得观测到样本数据的可能性最大，即最大化对数似然函数：$$\max_{\theta} \ln L(\theta\ ;\ y_1,\cdots,y_n)$$
无约束极值问题的一阶条件为：$$\frac{\partial  L(\theta\ ;y_1,\cdots,y_n)}{\partial \theta} = 0$$
求解此一阶条件，即可得到最大似然估计量 $\hat \theta_{ML}$

MLE估计量具有良好的大样本性质，可照常进行大样本统计推断。
- 是一致估计，$p\lim_{n \to \infty} \hat\theta_{ML} = \theta$
- 服从渐近正太分布
- 大样本下，渐近方差最小

非线性方程，通常没有解析解，只能寻找数值解。常用迭代法求数值解，高斯-牛顿法（Gauss-Newton Method）
- 解不唯一
- 求得的可能是局部最大值
## 11.3 二值选择模型的MLE估计
## 11.4 三种边际效应
线性模型回归系数：边际效应
非线性模型回归系数：通常不是常数，随x变化
- 平均边际效应
- 样本均值处边际效应
- 某代表值处边际效应
## 11.5 回归系数的经济意义

对于Logit模型，回归系数意味着：
- 几率(odds)：$$\hat\beta = \frac{p}{1-p}$$
在实际运用中还可能运用到：
- 对数几率(log-odds):$$\ln(\hat\beta)=\ln(\frac{p}{1-p})$$
- 几率比(odds-ratio):$$exp(\hat\beta_j) = \frac{\frac{p^*}{1-P^*}}{\frac{p}{1-p}}$$
## 11.6 拟合优度

- 准$R^2$(qusai-R-square)
- 正确预测百分比（precent correctly predicted）
## 11.7 准最大似然估计

## 11.8 三类渐近等价的大样本检验

- （1）沃尔德检验（wald test）
- （2）似然比检验（LR）
- （3）拉格朗日算子检验（LM）

## 11.9 二值选择模型的Stata命令及实例

[[Chapter_11.ipynb]]

## 11.10 其他离散选择模型




