# 第9章 模型设定与数据问题

如果模型设定不当，会带来设定误差（specification error）
- [[#9.1 遗漏变量|9.1 遗漏变量]]
- [[#9.2 无关变量|9.2 无关变量]]
- [[#9.3 建模策略：“由小到大”还是“由大到小”？|9.3 建模策略：“由小到大”还是“由大到小”？]]
- [[#9.4 解释变量个数的选择|9.4 解释变量个数的选择]]
- [[#9.5 对函数形式的检验|9.5 对函数形式的检验]]
另外，数据本事也可能存在问题:
- [[#9.6 多重共线性|9.6 多重共线性]]
- [[#9.7 极端数据|9.7 极端数据]]
- [[#9.8 虚拟变量|9.8 虚拟变量]]
- [[#9.9 经济结构变动的检验|9.9 经济结构变动的检验]]
- [[#9.10 缺失数据与线性插值|9.10 缺失数据与线性插值]]
- [[#9.11 变量单位的选择|9.11 变量单位的选择]]
## 9.1 遗漏变量

由于某些数据难以获取，遗漏变量现象几乎难以避免。遗漏变量是否一定导致不一致的估计？
1. 遗漏变量$x_2$与解释变量$x_1$不相关：OLS可一致估计，但扰动项方差增大
2. 遗漏变量$x_2$与解释变量$x_1$相关：OLS估计不一致

解决遗漏变量的方法：
1. 加入尽可能多的控制变量
2. 随机实验与自然实验
3. 工具变量法
4. 面板数据
## 9.2 无关变量

与遗漏变量相反，加入了与被解释变量无关的变量。
- OLS仍然一致
- 估计量的方差会增大
## 9.3 建模策略

“由小到大”还是“由大到小”？
- 折中，凭感觉来。
## 9.4 解释变量个数的选择

好的经济理论应该能用简洁的模型很好的描述复杂的经济现实。但解释力（增大拟合优度）和简洁性（parismony）是两个矛盾的目标，需要如下方法进行权衡：
### 校正可决系数
选择K，使 $\overline R^2$ 最小
### 赤池信息准则
（AIC，Akaike Information Criterion）
- 选择解释变量的个数，使目标函数最小$$\min_{K}AIC\equiv\ln(\frac{SSR}{n}+\frac{2}{n}K)$$
### 贝叶斯信息准则
（BIC，Bayesian Information Criterion）/施瓦茨信息准则（SIC）
- 选择解释变量的个数K，使目标函数最小$$\min_{K}BIC\equiv\ln(\frac{SSR}{n}+\frac{\ln n}{n}K)$$
### 由大到小的序贯t规则
常用于时间序列模型
- 指定一个最大滞后期$P_{max}$，
- 令$\hat P \equiv P_{max}$，进行估计，对最后一阶系数做t检验。如接受系数为0，则
	- 同时还可以观察AIC和BIC的变化
- 令$\hat P \equiv P_{max}-1$，进行估计，对最后一阶系数做t检验。如显著，则停止，
	- 否则依次类推。
## 9.5 对函数形式的检验

很多经济关系是非线性的。如果存在非线性项，但遗漏了，是<span style="color:#00b0f0">模型设定误差（specification error）</span>的一种形式。可使用如下检验方法：
### Ramsey's RESET检验
基本思想：如怀疑非线性项被遗漏，则加入非线性项，并检验其系数是否显著。
- 既可以接受被解释变量高次项
- 也可以接受解释变量的高次项

> 代码: [[Chapter_09.ipynb]]
## 9.6 多重共线性
### 定义
#定义 严格多重共线性
某解释变量可由其他解释变量线性表出。数据矩阵X不满秩，$X'X$不可逆。

#定义 多重共线性
将第k个解释变量对其余解释变量进行回归，可决系数 $R^2$ 较高
- OLS仍是BLUE
- 表现：
	- 回归方程 $R^2$ 较大，F检验也很显著，但是对单个系数的t检验却不显著
	- 增减解释变量使得系数估计值发生较大变化
### 检验方法
#定义 方差膨胀因子（VIF，Variance Inflation Factor）
$$VIF_k \equiv \frac{1}{1-R^2}$$
可以证明$$Var(\hat\beta_k|X)=\frac{1}{1-R^2}·\frac{\sigma^2}{S_k}=VIF_k\frac{\sigma^2}{S_k}$$
- $\sigma^2\equiv Var(\epsilon)$ 扰动项方差
- $S_k \equiv \sum_{i=1}^n(x_{ik}-\overline x_k)^2$ 为$x_k$的离差平方和

```ad-tip
title:经验
$VIF_k$ 越大，说明$x_k$ 的多重共线性越严重。在判断是否存在多重共线性的一个经验规则是：
- $\{VIF_1,\cdots,VIF_k \}$ 的最大值不应超过10


```
### 处理方法

1. 如果不关系具体的回归系数，只关心整个方程预测能力
	- 不必理会多重共线性，因为方程是显著的
2. 如果关系具体的回归系数，但多重共线性不影响所关心的那个变量
	- 不必理会
3. 如果多重共线性影响到所关心变量的显著性，则应设法处理
	1. 增大样本容量
	2. 剔出导致严重共线性的变量
	3. 将变量标准化：减去均值，除以标准差
	4. 修改模型设定

> 解释变量之间存在相关性是普遍存在的，在一定程度上也是允许的。最常见的处理方法是“无为而治”。

案例 [[Chapter_09.ipynb]]
## 9.7 极端数据
### 定义
#定义 极端值、离群值、高影响力数据
如果样本中有少数观测值离大多数观测值很远，可能对OLS的回归系数产生很大影响。
### 处理方法
- 检查数据是否正确录入
- 看极端值的背景，必要时直接删除
- 同时报告含或不含极端值的回归结果
## 9.8 虚拟变量

#定义 虚拟变量
取值为0或1的变量
- 用于定性数据
- 或分类数据

例子：
- 性别：$$D = 
\begin{cases}
1, \ 男\\
0, \ 女
\end{cases}$$
- 五大洲：则需要4个虚拟变量
$$\begin{array}{rcl}
D_1 = 
\begin{cases}
1, \ 亚洲\\
0, \ 其他
\end{cases}
,\quad D_2 = 
\begin{cases}
1, \ 美洲\\
0, \ 其他
\end{cases}
,\quad D_3 = 
\begin{cases}
1, \ 欧洲\\
0, \ 其他
\end{cases}
,\quad D_4 = 
\begin{cases}
1, \ 非洲\\
0, \ 其他
\end{cases}
\end{array}$$
	- 当$D_1=D_2=D_3=D_4=0$， 则为大洋洲

#定义  虚拟变量陷阱
在有常数项的模型中，如果定性指标有M类，最多只能放入（M-1）个虚拟变量。

引入虚拟变量相当于在不同时期给予不同的截距项
引入虚拟变量和交互项相当于在不同时期给予不同的截距项和斜率
## 9.9 经济结构变动的检验

对于时间序列，模型系数的稳定性很重要。如果存在结构变动，但没考虑，也是一种模型设定误差。

邹检验 和 虚拟变量法 结果一致，虚拟变量
- 方便
- 可在存在异方差和自相关的情况下使用，只要在估计时，使用HAC标准误即可。
- 还可提供截距项和斜率变动的信息
## 9.10 缺失数据与线性插值

中间缺的数据，用两边的直接算平均值替代。
## 9.11 变量单位的选择
多个变量的单位，应该尽可能的避免变量间数量级差别过大。
直接取对数。
## 习题


